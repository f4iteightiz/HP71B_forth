S" HP41.fth" INCLUDED
\ W from https://www.hpmuseum.org/forum/thread-23365-post-203407.html#pid203407
\ translation steps into Forth
( )
\ 01 LBL "W"
: W
\ D_SSET
( )
\ 02 1
1.0E0
\ D_SSET \ after each numeric given    
( )
\ 03 STO 01
1 REG41 STO
( )
\ 04 7
7.0E0
\ D_SSET \ after each numeric given
( )
\ 05 RCL Z
Z RCL
( )
\ 06 LBL 06
BEGIN 
( )
\ 07 X>Y?
\ 08 GTO 13    
    X>Y?
    NOT
WHILE
\ 09 ST* 01
1 REG41 ST*
\ 10 1
\ 11 +
X+1
REPEAT
\ 12 GTO 06
\ 13 LBL 13
\ 14 ENTER
FENTER
\ 15 STO Z
Z STO
\ 16 4
4.0E0
\ D_SSET 
\ 17 *
G_F*
\ 18 1/X
1/X
\ 19 +
G_F+
\ 20 30
30.0E0
\ D_SSET 
\ 21 *
G_F*
\ 22 1/X
1/X
\ 23 +
G_F+
\ 24 12
12.0E0
\ D_SSET 
\ 25 *
G_F*
\ 26 1/X
1/X
\ 27 E^X
E^X
\ 28 PI
PI
\ D_RPNS
\ 29 ST+ X
X ST+
\ 30 -1
-1.0E0
\ D_SSET
\ 31 E^X
E^X
\ 32 R^
RUP
\ 33 ST* Y
Y ST*
\ 34 ST/ Z
Z ST/
\ 35 Y^X
Y^X
\ 36 X<>Y
X<>Y
\ 37 SQRT
SQRT
\ 38 *
G_F*
\ 39 *
G_F*
\ 40 RCL 01
1 REG41 RCL
\ 41 /
G_F/
\ 42 END
; 
\ test
\ x         Γ(x)       ULP
\
\ -——————————————————————————-
\  -67.5   1.046513299-95 (-2)
\   -0.5     -3.544907704  (2) 
\    0.5      1.772453851  (0)
\    1.0      1.000000002  (2)
\    1.5      0.886226926  (6)
\    2.0      1.000000002  (2)
\    2.5      1.329340389  (1)
\ 3.0E0 W F.    ." 2.000000004  (4)" CR
\    3.5      3.323350973  (3)
\ 4.0E0 W F.    ." 6.000000011 (11)" CR
\    4.5      11.63172840  (0)
\ 5.0E0 W F.    ." 24.00000004  (4)" CR
\    5.5      52.34277782 (-3)
\    6.0      120.0000002  (2)
\    6.5      287.8852780  (2)
\    7.0      720.0000013 (13)
\    7.5     1,871.254307  (1)
\    8.0     5,040.000009  (9)
\    8.5     14,034.40730  (1)
\    9.0     40,320.00004  (4)
\    9.5     119,292.4620  (0)
\   10.0     362,880.0003  (3)
\   10.5    1,133,278.391  (2)
\   11.0    3,628,800.000  (0)
\   11.5    11,899,423.11  (3)
\   12.0    39,916,799.98 (-2)
\   12.5    136,843,365.6  (1)
\   13.0    479,001,601.2 (-4)
\   13.5    1,710,542,070. (2)
\   14.0   6,227,020,813. (13)
\   14.5   2.309231793+10  (1)
\   15.0   8.717829135+10 (15)
: WT
CR
D_SSET
\ -67.5E0 W F. ." 1.046513299-95 (-2)" CR
-0.5E0  W F. ." -3.544907704  (2)" CR 
\    0.5      1.772453851  (0)
\    1.0      1.000000002  (2)
1.5E0 W F.   ." 0.886226926  (6)" CR
\    2.0      1.000000002  (2)
\    2.5      1.329340389  (1)
3.0E0 W F.      ." 2.000000004  (4)" CR
3.5E0 W F.      ." 3.323350973  (3)" CR
4.0E0 W F.     ." 6.000000011 (11)" CR
\    4.5      11.63172840  (0)
5.0E0 W F.     ." 24.00000004  (4)" CR
\    5.5      52.34277782 (-3)
\    6.0      120.0000002  (2)
6.5E0 W F.  ." 287.8852780  (2)" CR
\    7.0      720.0000013 (13)
7.5E0 W F.  ." 1,871.254307  (1)" CR
\    8.0     5,040.000009  (9)
\    8.5     14,034.40730  (1)
\    9.0     40,320.00004  (4)
\    9.5     119,292.4620  (0)
\   10.0     362,880.0003  (3)
\   10.5    1,133,278.391  (2)
\   11.0    3,628,800.000  (0)
11.5E0 W F.    ." 11,899,423.11  (3)" CR
\   12.0    39,916,799.98 (-2)
\   12.5    136,843,365.6  (1)
\   13.0    479,001,601.2 (-4)
\   13.5    1,710,542,070. (2)
\   14.0   6,227,020,813. (13)
\   14.5   2.309231793+10  (1)
\   15.0   8.717829135+10 (15)
;